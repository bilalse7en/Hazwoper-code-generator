<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Content Generator Suite</title>
    <link rel="icon" href="" type="image/gif" id="animatedFavicon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="hero-section">
    <div class="container">
        <div class="row"> 
            <div class="col-12 text-center">
                <img src="https://staging-media.hazwoper-osha.com/wp-content/uploads/2025/10/1759824844/logo.gif" alt="Website Logo" style="height: 125px;width: auto;border-radius: 50%;" class="mb-3">
                <h1>Course Content Generator Suite</h1>
                <p class="lead text-center text-light">Extract Overview, Syllabus, FAQs, Glossary, Resources and Blog Content from your documents</p>
            </div>
        </div>
    </div>
</div>

<div class="container mb-5">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="course-tab" data-bs-toggle="tab" data-bs-target="#course" type="button" role="tab" aria-controls="course" aria-selected="true">
                <i class="fas fa-graduation-cap me-2"></i>Web Content Generator
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="glossary-tab" data-bs-toggle="tab" data-bs-target="#glossary" type="button" role="tab" aria-controls="glossary" aria-selected="false">
                <i class="fas fa-book me-2"></i>Glossary Generator
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="resources-tab" data-bs-toggle="tab" data-bs-target="#resources" type="button" role="tab" aria-controls="resources" aria-selected="false">
                <i class="fas fa-file-excel me-2"></i>Resource Generator
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="blog-tab" data-bs-toggle="tab" data-bs-target="#blog" type="button" role="tab" aria-controls="blog" aria-selected="false">
                <i class="fas fa-blog me-2"></i>Blog Generator
            </button>
        </li>
    </ul>
    
    <div class="tab-content" id="myTabContent">
        <!-- Course Content Tab -->
        <div class="tab-pane fade show active" id="course" role="tabpanel" aria-labelledby="course-tab">
            <div class="section-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-file-word text-warning me-2"></i>Upload DOCX File</h4>
                            </div>
                            <div class="card-body">
                                <!-- Course Name Input -->
                                <div class="mb-3">
                                    <label for="courseNameInput" class="form-label">Course Name</label>
                                    <input type="text" class="form-control" id="courseNameInput" placeholder="Enter course name (e.g., Swing Stage Scaffold Training)">
                                </div>
                                
                                <!-- Demo File Download Button -->
                                <div class="mb-3">
                                    <p class="text-light">Download our demo file to check the required structure. Create your course file following the same format, then upload for easy website content code generation.</p>
                                    <button class="btn btn-outline-primary btn-sm" onclick="downloadDemoFile()">
                                        <i class="fas fa-download me-2"></i>Download Demo File
                                    </button>
                                </div>
                                
                                <input class="form-control" type="file" id="courseFileInput" accept=".docx" />
                                <div class="file-info mt-2" id="courseFileInfo"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container card mb-4" id="courseProgress">
                            <div class="card-body">
                                <div class="progress mb-2"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div></div>
                                <div class="text-center" id="courseProgressText">Processing...</div>
                            </div>
                        </div>
            
                        <div class="card">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-cogs text-info me-2"></i>Generate Content</h4>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2 d-md-block">
                                    <button class="btn btn-primary me-2 mb-2" onclick="uploadCourseFile()"><i class="fas fa-upload me-2"></i>Upload File</button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateOverviewCode()"><i class="fas fa-code me-2"></i>Generate Overview</button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateCourseObjectivesCode()"><i class="fas fa-code me-2"></i>Course Objectives</button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateSyllabusCode()"><i class="fas fa-code me-2"></i>Generate Syllabus</button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateFAQCode()"><i class="fas fa-code me-2"></i>Generate FAQ</button>
                                    <button class="btn btn-outline-info me-2 mb-2" onclick="debugFAQs()"><i class="fas fa-bug me-2"></i>Debug FAQs</button>
                                    <button class="btn btn-outline-info me-2 mb-2" onclick="debugExtraction()"><i class="fas fa-bug me-2"></i>Debug Extraction</button>
                                </div>
                            </div>
                        </div>
                    </div>
            
                    <div class="col-md-6">
                        <div id="courseCodeArea" class="generated-content-area">
                            <div id="courseEmptyState" class="empty-state">
                                <i class="fas fa-code"></i>
                                <h4>No Code Generated Yet</h4>
                                <p>Upload a file and generate content to see the code here</p>
                            </div>
                            
                            <div id="courseCodeSelector" class="code-selector" style="display: none;">
                                <button class="code-selector-btn active" data-target="overviewCodeSection">Overview</button>
                                <button class="code-selector-btn" data-target="courseObjectivesCodeSection">Course Objectives</button>
                                <button class="code-selector-btn" data-target="syllabusCodeSection">Syllabus</button>
                                <button class="code-selector-btn" data-target="faqCodeSection">FAQ</button>
                            </div>
                            
                            <div id="courseCodeSections">
                                <div id="overviewCodeSection" class="code-section">
                                    <div class="card">
                                        <div class="code-header">
                                            <h4 class="code-title"><i class="fas fa-code text-warning"></i>Overview Code</h4>
                                            <div class="code-actions">
                                                <button class="preview-icon-btn" onclick="openPreviewDrawer('overviewCode', 'Overview')">
                                                    <i class="fas fa-eye"></i> Preview
                                                </button>
                                                <button class="copy-btn" onclick="copyToClipboard('overviewCode')">
                                                    <i class="fas fa-copy"></i> Copy
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <textarea class="code-editor" id="overviewCode" rows="8" placeholder="Overview code will appear here after generation"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div id="courseObjectivesCodeSection" class="code-section">
                                    <div class="card mt-4">
                                        <div class="code-header">
                                            <h4 class="code-title"><i class="fas fa-code text-warning"></i>Course Objectives Code</h4>
                                            <div class="code-actions">
                                                <button class="preview-icon-btn" onclick="openPreviewDrawer('courseObjectivesCode', 'Course Objectives')">
                                                    <i class="fas fa-eye"></i> Preview
                                                </button>
                                                <button class="copy-btn" onclick="copyToClipboard('courseObjectivesCode')">
                                                    <i class="fas fa-copy"></i> Copy
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <textarea class="code-editor" id="courseObjectivesCode" rows="8" placeholder="Course objectives code will appear here after generation"></textarea>
                                        </div>
                                    </div>
                                </div>
                                
                                <div id="syllabusCodeSection" class="code-section">
                                    <div class="card mt-4">
                                        <div class="code-header">
                                            <h4 class="code-title"><i class="fas fa-code text-warning"></i>Syllabus Code</h4>
                                            <div class="code-actions">
                                                <button class="preview-icon-btn" onclick="openPreviewDrawer('syllabusCode', 'Syllabus')">
                                                    <i class="fas fa-eye"></i> Preview
                                                </button>
                                                <button class="copy-btn" onclick="copyToClipboard('syllabusCode')">
                                                    <i class="fas fa-copy"></i> Copy
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <textarea class="code-editor" id="syllabusCode" rows="8" placeholder="Syllabus code will appear here after generation"></textarea>
                                        </div>
                                    </div>
                                </div>

                                <div id="faqCodeSection" class="code-section">
                                    <div class="card mt-4">
                                        <div class="code-header">
                                            <h4 class="code-title"><i class="fas fa-code text-info"></i>FAQ Code</h4>
                                            <div class="code-actions">
                                                <button class="preview-icon-btn" onclick="openPreviewDrawer('faqCode', 'FAQ')">
                                                    <i class="fas fa-eye"></i> Preview
                                                </button>
                                                <button class="copy-btn" onclick="copyToClipboard('faqCode')">
                                                    <i class="fas fa-copy"></i> Copy
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body p-0">
                                            <textarea class="code-editor" id="faqCode" rows="8" placeholder="FAQ code will appear here after generation"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Blog Tab -->
        <div class="tab-pane fade" id="blog" role="tabpanel" aria-labelledby="blog-tab">
            <div class="section-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-file-word text-warning me-2"></i>Upload DOCX File</h4>
                            </div>
                            <div class="card-body">
                                <input class="form-control" type="file" id="blogFileInput" accept=".docx" />
                                <div class="file-info mt-2" id="blogFileInfo"></div>
                            </div>
                        </div>
                        
                        <!-- Featured Image Section - ALWAYS VISIBLE -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-star text-warning me-2"></i>Featured Image (Appears after H1)</h4>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label">Image URL:</label>
                                    <input type="text" class="form-control" id="featuredImageUrl" 
                                           placeholder="https://example.com/featured-image.jpg">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Alt Text:</label>
                                    <input type="text" class="form-control" id="featuredImageAlt" 
                                           placeholder="Description of the image for accessibility">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Title Text:</label>
                                    <input type="text" class="form-control" id="featuredImageTitle" 
                                           placeholder="Title of the image">
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress-container card mb-4" id="blogProgress">
                            <div class="card-body">
                                <div class="progress mb-2"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div></div>
                                <div class="text-center" id="blogProgressText">Processing...</div>
                            </div>
                        </div>

                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-cogs text-info me-2"></i>Generate Blog</h4>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2 d-md-block">
                                    <button class="btn btn-primary me-2 mb-2" onclick="uploadBlogFile()"><i class="fas fa-upload me-2"></i>Upload File</button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateBlogCode()"><i class="fas fa-code me-2"></i>Generate Blog Code</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card" id="imageInputsContainer" style="display: none;">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-images text-info me-2"></i>Content Images</h4>
                            </div>
                            <div class="card-body">
                                <p class="text-light">Add image URLs that appear in your blog content.</p>
                                <div id="imageInputs"></div>
                                <button class="btn btn-outline-info btn-sm mt-2" onclick="addImageInput()"><i class="fas fa-plus me-1"></i>Add Another Image</button>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div id="blogCodeArea" class="generated-content-area">
                            <div id="blogEmptyState" class="empty-state">
                                <i class="fas fa-code"></i>
                                <h4>No Blog Code Generated Yet</h4>
                                <p>Upload a file and generate blog content to see the code here</p>
                            </div>
                            
                            <div id="blogCodeSection" class="code-section">
                                <div class="card">
                                    <div class="code-header">
                                        <h4 class="code-title"><i class="fas fa-code text-warning"></i>Generated Blog Code</h4>
                                        <div class="code-actions">
                                            <button class="preview-icon-btn" onclick="openPreviewDrawer('blogCode', 'Blog')">
                                                <i class="fas fa-eye"></i> Preview
                                            </button>
                                            <button class="copy-btn" onclick="copyToClipboard('blogCode')">
                                                <i class="fas fa-copy"></i> Copy
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <textarea class="code-editor" id="blogCode" rows="20" placeholder="Blog code will appear here after generation"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Glossary Tab -->
        <div class="tab-pane fade" id="glossary" role="tabpanel" aria-labelledby="glossary-tab">
            <div class="section-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-file-word text-primary me-2"></i>Upload DOCX File</h4>
                            </div>
                            <div class="card-body">
                                <input class="form-control" type="file" id="glossaryFileInput" accept=".docx" />
                                <div class="file-info mt-2" id="glossaryFileInfo"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container card mb-4" id="glossaryProgress">
                            <div class="card-body">
                                <div class="progress mb-2">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                                <div class="text-center" id="glossaryProgressText">Processing...</div>
                            </div>
                        </div>
        
                        <div class="card">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-cogs text-info me-2"></i>Generate Glossary</h4>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2 d-md-block">
                                    <button class="btn btn-primary me-2 mb-2" onclick="uploadGlossaryFile()">
                                        <i class="fas fa-upload me-2"></i>Upload File
                                    </button>
                                    <button class="btn btn-success me-2 mb-2" onclick="generateGlossary()">
                                        <i class="fas fa-code me-2"></i>Generate Glossary Code
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div id="glossaryCodeArea" class="generated-content-area">
                            <div id="glossaryEmptyState" class="empty-state">
                                <i class="fas fa-code"></i>
                                <h4>No Glossary Code Generated Yet</h4>
                                <p>Upload a file and generate glossary content to see the code here</p>
                            </div>
                            
                            <div id="glossaryCodeSection" class="code-section">
                                <div class="card">
                                    <div class="code-header">
                                        <h4 class="code-title"><i class="fas fa-code text-success"></i>Generated Glossary Code</h4>
                                        <div class="code-actions">
                                            <button class="preview-icon-btn" onclick="openPreviewDrawer('glossaryCode', 'Glossary')">
                                                <i class="fas fa-eye"></i> Preview
                                            </button>
                                            <button class="copy-btn" onclick="copyToClipboard('glossaryCode')">
                                                <i class="fas fa-copy"></i> Copy
                                            </button>
                                            </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <textarea class="code-editor" id="glossaryCode" rows="20" placeholder="Glossary code will appear here after generation"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Resources Tab -->
        <div class="tab-pane fade" id="resources" role="tabpanel" aria-labelledby="resources-tab">
            <div class="section-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card mb-4">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-file-excel text-success me-2"></i>Upload Excel File</h4>
                            </div>
                            <div class="card-body">
                                <input id="resourceFileInput" type="file" accept=".xlsx,.xls" class="form-control"/>
                                <div class="file-info mt-2" id="resourceFileInfo"></div>
                            </div>
                        </div>
                        
                        <div class="progress-container card mb-4" id="resourceProgress">
                            <div class="card-body">
                                <div class="progress mb-2">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                                </div>
                                <div class="text-center" id="resourceProgressText">Processing...</div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h4 class="mb-0"><i class="fas fa-cogs text-info me-2"></i>Process Resources</h4>
                            </div>
                            <div class="card-body">
                                <div class="d-grid gap-2 d-md-block">
                                    <button class="btn btn-primary mb-2" onclick="processResourceFile()">
                                        <i class="fas fa-upload me-2"></i>Process File
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div id="resourcesCodeArea" class="generated-content-area">
                            <div id="resourcesEmptyState" class="empty-state">
                                <i class="fas fa-code"></i>
                                <h4>No Resource HTML Generated Yet</h4>
                                <p>Upload a file and process resources to see the HTML here</p>
                            </div>
                            
                            <div id="resourcesCodeSection" class="code-section">
                                <div class="card">
                                    <div class="code-header">
                                        <h4 class="code-title"><i class="fas fa-code text-primary"></i>Generated HTML</h4>
                                        <div class="code-actions">
                                            <button class="preview-icon-btn" onclick="openPreviewDrawer('htmlOutput', 'Resources')">
                                                <i class="fas fa-eye"></i> Preview
                                            </button>
                                            <button class="copy-btn" onclick="copyToClipboard('htmlOutput')">
                                                <i class="fas fa-copy"></i> Copy
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body p-0">
                                        <textarea class="code-editor" id="htmlOutput" rows="20" placeholder="Resource HTML will appear here after processing"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- PREVIEW DRAWER COMPONENT -->
<div class="preview-drawer-overlay" id="previewDrawerOverlay" onclick="closePreviewDrawer()"></div>
<div class="preview-drawer" id="previewDrawer" role="dialog" aria-modal="true" aria-labelledby="previewDrawerTitle">
    <div class="preview-drawer-header">
        <h3 class="preview-drawer-title" id="previewDrawerTitle"><i class="fas fa-eye me-2"></i>Preview</h3>
        <div class="preview-drawer-actions">
            <button class="btn btn-success" id="copyCodeDrawerBtn">
                <i class="fas fa-copy me-1"></i> Copy Code
            </button>
            <button class="btn btn-secondary" onclick="closePreviewDrawer()">
                <i class="fas fa-times me-1"></i> Close
            </button>
        </div>
    </div>
    <div class="preview-drawer-body" id="previewDrawerContent">
        <!-- Preview content will be inserted here -->
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/utils.js"></script>
<script src="js/main.js"></script>
<script src="js/course-generator.js"></script>
<script src="js/blog-generator.js"></script>
<script src="js/glossary-generator.js"></script>
<script src="js/resource-generator.js"></script>
</script>
